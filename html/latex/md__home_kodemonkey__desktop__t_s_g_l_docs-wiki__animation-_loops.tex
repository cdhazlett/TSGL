Let's make a loop-\/da-\/loop!

Now that you know how to draw simple shapes and use colors, it's time to learn how to make animations!

$\ast$$\ast$$\ast$\-Linux/\-Mac users\-:$\ast$$\ast$$\ast$ Follow the steps from the previous tutorials. Name the folder \char`\"{}\-Tutorial5\char`\"{} and the file \char`\"{}animation.\-cpp\char`\"{}. Replace \char`\"{}program\char`\"{} in the \char`\"{}\-T\-A\-R\-G\-E\-T\char`\"{} line of the Makefile with \char`\"{}animation\char`\"{}.

$\ast$$\ast$$\ast$\-Windows users\-:$\ast$$\ast$$\ast$ Follow the steps from the previous tutorials. Name the Solution folder \char`\"{}\-Tutorial5\char`\"{} and the Visual Studio project \char`\"{}\-Animation\char`\"{}. After adding the Property sheet, name the .cpp file \char`\"{}animation.\-cpp\char`\"{}.

$\ast$$\ast$$\ast$\-All three platforms\-:$\ast$$\ast$$\ast$ Follow the steps in the \mbox{[}\mbox{[}Building Programs\mbox{]}\mbox{]} page on how to compile and run the program (Linux/\-Mac users, this is a single-\/file program).

Before we begin, allow us to explain drawing loops.

Drawing loops are what allow us to make animations.

They are essentially while loops that execute code as long as the Canvas remains open.

Let's look at an example\-:


\begin{DoxyCode}
\textcolor{keywordflow}{while}(canvasName.isOpen()) \{
   canvasName.sleep();
  \textcolor{comment}{//Code to execute as long as the Canvas is open...}
\}
\end{DoxyCode}


This is the skeleton code for a drawing loop. The while loop executes its code as long as the accessor method, {\ttfamily is\-Open()}, returns {\ttfamily true}. This method essentially checks if the Canvas window is still open and returns {\ttfamily true} if it is.

The {\ttfamily sleep()} method tells the Canvas to wait until something is ready to be drawn and then draw it once its ready.

Drawing loops are key to making a Canvas continually draw something until its closed. Let's make one!

First, let's start by making and initializing a Canvas\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  c.wait();
\}
\end{DoxyCode}


Now, let's introduce our drawing loop\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
  \}
  c.wait();
\}
\end{DoxyCode}


Now, let's have the Canvas draw something\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Let's draw a circle!}
    c.drawCircle(250, 300, 50, 32);
  \}
  c.wait();
\}
\end{DoxyCode}


Compile and run the code. A black circle should appear in the center.

But wait...it's not doing anything. It's just drawing the same thing over and over again!

That's because we haven't told the Canvas to move something in our drawing loop.

In order to make something move, we can change the x and y-\/coordinates so that the Canvas redraws it every frame, like so\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  \textcolor{comment}{//Store the x and y-coordinate values in variables outside of the loop}
  \textcolor{keywordtype}{int} x = 250, y = 300;
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Let's draw a circle!}
    \textcolor{comment}{//Pass the x and y coordinates}
    c.drawCircle(x, y, 50, 32);
    \textcolor{comment}{//And change the x-coordinate once the circle has been drawn}
    x += 5;
  \}
  c.wait();
\}
\end{DoxyCode}
 Recompile and run the code. The circle should move from left to right.

We animated something! But...the Canvas keeps drawing a new circle with the new x-\/coordinate over the old circle with the old x-\/coordinate so now it looks like a tube. Is there anyway we can make it so that the Canvas just redraws the same circle with a new x-\/coordinate every frame?

Of course there is\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  \textcolor{comment}{//Store the x and y-coordinate values in variables outside of the loop}
  \textcolor{keywordtype}{int} x = 250, y = 300;
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Let's draw a circle!}
    \textcolor{comment}{//Pass the x and y coordinates}
    c.drawCircle(x, y, 50, 32);
    \textcolor{comment}{//And change the x-coordinate once the circle has been drawn}
    x += 5;
    c.clear(); \textcolor{comment}{//New statement}
  \}
  c.wait();
\}
\end{DoxyCode}


Recompile and run the code. Now the circle appears to be moving on its own!

The {\ttfamily clear()} method tells the Canvas to clear the screen so that its blank again.

By placing that method call at the end of the draw loop, the Canvas will draw a circle, change the x-\/coordinate, clear itself, and then redraw the circle with the new x-\/coordinate in the next frame.

The circle just moves off screen though...is there anyway to make it so that once it goes off screen it gets redrawn back onto the screen?

Certainly\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"});
  c.start();
  \textcolor{comment}{//Store the x and y-coordinate values in variables outside of the loop}
  \textcolor{keywordtype}{int} x = 250, y = 300;
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Check to see if we are off screen}
    \textcolor{keywordflow}{if} (x >= c.getWindowWidth()) \{
       x = 250; \textcolor{comment}{//If so, reset the x-coordinate}
    \}
    \textcolor{comment}{//Let's draw a circle!}
    \textcolor{comment}{//Pass the x and y coordinates}
    c.drawCircle(x, y, 50, 32);
    \textcolor{comment}{//And change the x-coordinate once the circle has been drawn}
    x += 5;
    c.clear(); \textcolor{comment}{//New statement}
  \}
  c.wait();
\}
\end{DoxyCode}


{\ttfamily c.\-get\-Window\-Width()} is the accessor for the width of the current Canvas. If the x-\/coordinate value is greater than or equal to that value, then it gets reset back to 250 and so appears to be animated!

There is also another accessor method, {\ttfamily get\-Window\-Height()}, which gets the height of the current Canvas.

In sum, in order to have an animation, follow these steps\-:

1). Create and initialize a Canvas object.

2). Call the {\ttfamily start()} and {\ttfamily wait()} methods.

3). In between the calls to the {\ttfamily start()} and {\ttfamily wait()} methods, place the drawing loop\-:


\begin{DoxyCode}
\textcolor{keywordflow}{while}(canvasName.isOpen()) \{
  canvasName.sleep();
  \textcolor{comment}{//Code to draw something....}
  canvasName.clear(); \textcolor{comment}{//At the very end of the loop}
\}
\end{DoxyCode}


4). Done!

There is an optional parameter in the Canvas constructor that controls the speed at which the circle moves, and that is the {\ttfamily timer\-Length} parameter. It essentially sets the length of time that the {\ttfamily c.\-sleep()} call will cause the Canvas to sleep each iteration of the animation loop.

T\-S\-G\-L has a constant for the standard length of time that the timer should keep\-: {\ttfamily F\-R\-A\-M\-E}. When we pass this constant as the timer length parameter, the internal timer will expire every 1/60ths of a second and the Canvas will update itself. The standard frame rate of the T\-S\-G\-L library is 60 frames a second.

Let's see what happens when we pass that constant as a parameter\-:


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"}, FRAME);
  c.start();
  \textcolor{comment}{//Store the x and y-coordinate values in variables outside of the loop}
  \textcolor{keywordtype}{int} x = 250, y = 300;
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Check to see if we are off screen}
    \textcolor{keywordflow}{if} (x >= c.getWindowWidth()) \{
       x = 250; \textcolor{comment}{//If so, reset the x-coordinate}
    \}
    \textcolor{comment}{//Let's draw a circle!}
    \textcolor{comment}{//Pass the x and y coordinates}
    c.drawCircle(x, y, 50, 32);
    \textcolor{comment}{//And change the x-coordinate once the circle has been drawn}
    x += 5;
    c.clear(); \textcolor{comment}{//New statement}
  \}
  c.wait();
\}
\end{DoxyCode}


Recompile and run. The circle will still move at the same speed.

However, if we alter the timer length parameter, we can change the speed of the animation!


\begin{DoxyCode}
\textcolor{preprocessor}{#include <tsgl.h>}
\textcolor{keyword}{using namespace }tsgl;

\textcolor{keywordtype}{int} main() \{
  \hyperlink{classtsgl_1_1_canvas}{Canvas} c(0, 0, 500, 600, \textcolor{stringliteral}{"Animation Loop Example"}, FRAME / 2);
  c.start();
  \textcolor{comment}{//Store the x and y-coordinate values in variables outside of the loop}
  \textcolor{keywordtype}{int} x = 250, y = 300;
  \textcolor{comment}{//Drawing loop}
  \textcolor{keywordflow}{while}(c.isOpen()) \{
    c.sleep();
    \textcolor{comment}{//Check to see if we are off screen}
    \textcolor{keywordflow}{if} (x >= c.getWindowWidth()) \{
       x = 250; \textcolor{comment}{//If so, reset the x-coordinate}
    \}
    \textcolor{comment}{//Let's draw a circle!}
    \textcolor{comment}{//Pass the x and y coordinates}
    c.drawCircle(x, y, 50, 32);
    \textcolor{comment}{//And change the x-coordinate once the circle has been drawn}
    x += 5;
    c.clear(); \textcolor{comment}{//New statement}
  \}
  c.wait();
\}
\end{DoxyCode}


Recompile and run. Dividing the {\ttfamily F\-R\-A\-M\-E} constant by 2 will speed up the animation!

We encourage you to try other divisors and see how they affect the animation rate!

As mentioned, there is a special kind of Canvas\-: The Cartesian\-Canvas. Drawing loops and animations are handled in the same way (only with a Cartesian coordinate system).

That completes this tutorial!

Next up, in \mbox{[}\mbox{[}Using Functions\mbox{]}\mbox{]}, we explain the special Canvas\-: The Cartesian\-Canvas! 