$\ast$$\ast$$\ast$\-W\-O\-R\-K I\-N P\-R\-O\-G\-R\-E\-S\-S!!!$\ast$$\ast$$\ast$ 

 \subsection*{$\vert$ H\-O\-W T\-O C\-R\-E\-A\-T\-E N\-E\-W T\-S\-G\-L D\-E\-B\-I\-A\-N P\-A\-C\-K\-A\-G\-E\-S F\-O\-R U\-B\-U\-N\-T\-U (Last updated\-: 07/21/16) $\vert$ }

(Example of making the same package for a different distro\-: tsgl (1.\-1-\/1$\sim$$<$distro-\/name$>$) $<$distro-\/name$>$

$\ast$$\ast$$\ast$\-N\-O\-T\-E\-:$\ast$$\ast$$\ast$ This document guides you in the process of creating Debian packages by hand. The package creation process has already been automated, so you do not need to follow this document if the automation process is working fine. If, however, the automation process has failed and you need to make an R\-P\-M package by hand, please continue to read the document. D\-O N\-O\-T A\-T\-T\-E\-M\-P\-T T\-O C\-R\-E\-A\-T\-E A D\-E\-B\-I\-A\-N P\-A\-C\-K\-A\-G\-E B\-Y H\-A\-N\-D I\-F T\-H\-E A\-U\-T\-O\-M\-A\-T\-I\-O\-N P\-R\-O\-C\-E\-S\-S I\-S S\-T\-I\-L\-L F\-U\-N\-C\-T\-I\-O\-N\-A\-L!!!

$\ast$$\ast$$\ast$\-N\-O\-T\-E\-:$\ast$$\ast$$\ast$ This document attempts to guide you in the process of Debian package creation. Given that, package creation can be a long and complex process. If there's something that we missed, or perhaps have misleading information, please edit this page accordingly!

Hello!

So, you need to make a new Debian package for T\-S\-G\-L.

Package creation isn't trivial, and has a steep learning curve.

What's more, we think that creating a Debian package is a $\ast$$\ast$$\ast$\-L\-O\-T$\ast$$\ast$$\ast$ more complex than creating an R\-P\-M package.

Luckily, this document will attempt to guide you through the process.

Let's get started with a brief intro to Debian packages. 

 \subsection*{$\vert$ Creating Debian packages\-: intro $\vert$ }

Alright! The P\-P\-A is all set up, the library has been updated, coffee has been made, you're ready to go!

Now, what's in a debian package?

Magic? Close.

There are three components to a Debian package\-:

1). Upstream tarball -\/ the original source code for the library/application. This comes from developers \char`\"{}upstream\char`\"{}, which means that they are the original authors of the code. 2). Source package -\/ has all of the necessary files needed to compile/build the software. Includes\-: the upstream tarball with .tar.\-gz ending, a description file (.dsc), and a tarball with any changes made to the upstream source code and all files created for the debian package. 3). Binary packages -\/ what actually get installed on a user's system.

You usually have to get the upstream tarball from some developers who are working on a piece of software. (You type \char`\"{}sudo apt-\/get source $<$package-\/name$>$\char`\"{} in order to fetch it).

In this case, however, the upstream tarball will be created by you. You, and everyone else who has worked on this library, are considered as the original authors of the code inside of it. Therefore, there is no need to get an upstream tarball. You'll create one yourself!

Follow these steps\-:

1). Create a new folder and call it \char`\"{}tsgl-\/$<$version-\/number$>$\char`\"{}, replacing $<$version-\/number$>$ with whatever version T\-S\-G\-L is currently. (If you've made changes to the library recently, bump up the middle number of the version number by one. i.\-e. 1.\-1.\-1 -\/$>$ 1.\-2.\-1). (If not, make no changes to the version number). 2). Go to wherever you have the T\-S\-G\-L folder (which you can get using git if you don't have it\-: git clone \href{https://www.github.com/Calvin-CS/TSGL.git}{\tt https\-://www.\-github.\-com/\-Calvin-\/\-C\-S/\-T\-S\-G\-L.\-git}). 3). Take A\-L\-L of the files in the T\-S\-G\-L folder, and copy them over to the tsgl-\/$<$version-\/number$>$ folder.

Okay, now we'll create the actual upstream tarball.

1). Open up a terminal, and go to the place where the tsgl-\/$<$version-\/number$>$ folder is located. 2). Type \begin{DoxyVerb}tar czvf tsgl-<version-number>.tar.gz tsgl-<version-number>
\end{DoxyVerb}
 3). Type ls, and you should see files that look like this\-: \begin{DoxyVerb}tsgl-<version-number>.tar.gz tsgl-<version-number> 
\end{DoxyVerb}


Congrats! You created the upstream tarball, and have taken your first step in making a Debian package. 

 \subsection*{$\vert$ Creating Debian packages\-: files, files, and more files $\vert$ }

Now that you have the upstream tarball created, it's time to get into the nitty gritty of packaging.

We'll go next into setting up the library to be made into a package.

You know how you have to prepare a turkey before actually cooking it?

The process is somewhat similar when creating a Debian package.

Go into the tsgl-\/$<$version-\/number$>$ folder after creating the upstream tarball. Create a folder named \char`\"{}debian\char`\"{}.

This one folder, debian, will store all of the necessary files needed in order to create a debian package.

And quite a lot of files we need....


\begin{DoxyItemize}
\item changelog
\item control
\item rules
\item compat
\item tsgl.\-install
\item copyright
\item source/format
\end{DoxyItemize}

There are M\-A\-N\-Y more, but these will suffice.

You're going to have to create each and every one of these files. Let's get started with the changelog. 

 \subsection*{$\vert$ changelog file $\vert$ }

This file essentially explains what has been changed in the Debian package. Ranging from a minor change to the control file (explained shortly), or a full scale rework of the entire package, you have to explain what you changed in this file. Don't worry, you don't have to explain E\-V\-E\-R\-Y little detail. You only have to summarize your changes.

This file is also E\-X\-T\-R\-E\-M\-E\-L\-Y picky in regards to format. There is a specific format for this file that {\itshape M\-U\-S\-T} be followed.

Since you're creating a brand new package, nothing's really been changed! So, you'll have to create the file. Luckily, there's a way to autogenerate this file.

To create the changelog file, be in the tsgl-\/$<$version-\/number$>$ directory, and type this command\-:

dch --create -\/v $<$version-\/number$>$ --package tsgl

(If dch isn't installed, sudo apt-\/get install devscripts).

You'll be asked to pick an editor. Pick whichever one is the easiest one to use.

Now, you should see something like this\-:

tsgl ($<$version-\/number-\/debnumber$>$) U\-N\-R\-E\-L\-E\-A\-S\-E\-D; urgency=medium


\begin{DoxyItemize}
\item Initial release. (Closes\-: \#\-X\-X\-X\-X\-X\-X)
\end{DoxyItemize}

-- kodemonkey $<$kodemonkey-\/desktop$>$ Mon, 06 Jun 2016 15\-:56\-:57 -\/0400

Let's break it down\-:


\begin{DoxyItemize}
\item tsgl ($<$version-\/number$>$) specifies the name of the package and the current version-\/number. The debnumber tells us what version is the D\-E\-B\-I\-A\-N package. In this case, since we are creating it, set this number to 1. If this were an already created package, we would have to bump up the debnumber by 1.
\item U\-N\-R\-E\-L\-E\-A\-S\-E\-D specifies the Linux distro that we developed the library for. trusty is Ubuntu 14.\-04, xenial is for Ubuntu 16.\-04. If you are creating a new T\-S\-G\-L package for either one of those distros, replace U\-N\-R\-E\-L\-E\-A\-S\-E\-D with the distro name. (If you are creating a new T\-S\-G\-L package for a new distro, please close this file and look at the \char`\"{}\-How\-To\-New\-Distros.\-txt\char`\"{} file).
\item urgency=medium specifies the priority level for this package. You can leave it as is.
\item $\ast$ Initial release. specifies what has been changed in the library. You can leave it as is.
\item Remove the (Closes\-: \#\-X\-X\-X\-X\-X\-X) as that is for bug fixes.
\item -- kodemonkey $<$kodemonkey-\/desktop$>$ Mon, 06 Jun 2016 15\-:56\-:57 -\/0400 specifies the person who made the changes (kodemonkey), an email that you can contact them by (kodemonkey-\/desktop), and the time and date that the changes were made. You'll want to replace the name and email with the ones associated with your ppa.
\end{DoxyItemize}

You should end up with a file like this after changes have been made\-:

tsgl (1.\-0-\/1) trusty; urgency=medium


\begin{DoxyItemize}
\item Initial release.
\end{DoxyItemize}

-- Chris Dilley \href{mailto:codemonkey941@gmail.com}{\tt codemonkey941@gmail.\-com} Mon, 06 Jun 2016 15\-:56\-:57 -\/0400

Save the changes and close the file. 

 \subsection*{$\vert$ control file $\vert$ }

This file tells apt-\/get how to manage the package.

It's also a real workhorse of a file.

Here's the general format\-:

1 Source\-: tsgl 2 Maintainer\-: Chris Dilley \href{mailto:codemonkey941@gmail.com}{\tt codemonkey941@gmail.\-com} 3 Section\-: libs 4 Priority\-: optional 5 Standards-\/\-Version\-: 3.\-9.\-5 6 Build-\/\-Depends\-: debhelper ($>$= 9), glfw, doxygen, libglew-\/dev, libglew1.\-10, libfreetype6-\/dev, libfreetype6, libxrandr-\/dev, libxi-\/dev, 7 x11proto-\/xf86vidmode-\/dev, libglu1-\/mesa-\/dev 8 9 Package\-: tsgl 10 Architecture\-: amd64 11 Depends\-: \$\{shlibs\-:Depends\}, \$\{misc\-:Depends\}, glfw, libfreetype6, libfreetype6-\/dev, libglew1.\-10, libglew-\/dev, libxrandr-\/dev, doxygen, devscripts, build-\/essential 12 Description\-: A Thread-\/\-Safe Graphics Library.

(Line numbers added)

As you can see, there are two sections. Lines 1-\/7 specify information for the source package, while lines 9-\/12 specify information for the binary package.

Let's break them down\-:

-\/---S\-O\-U\-R\-C\-E-\/---
\begin{DoxyItemize}
\item Source specifies the name of the source package.
\item Maintainer specifies the person who is keeping track of the package in terms of updates, tweaks, etc.
\item Section species the section of the distribution that the source package goes into (in this case, libs).
\item Priority specifies the importance of this package.
\item Standards-\/\-Version specifies the Debian standards for packaging that we are following.
\item Build-\/\-Depends specifies what libraries need to be present in order to build our library.
\end{DoxyItemize}

-\/---B\-I\-N\-A\-R\-Y-\/---
\begin{DoxyItemize}
\item Package specifies the name of the package. Note that the Source and Package name fields do N\-O\-T have to be the same.
\item Architecture specifies the architectures that the binary package can be compiled for.
\item Depends specifies what libraries need to be present in order for our binary package to behave correctly.
\item Description specifies a short summary of what the package is.
\end{DoxyItemize}

At the time of this writing, this was the control file for the trusty T\-S\-G\-L debian package.

This is the one for the xenial T\-S\-G\-L package\-:

Source\-: tsgl Maintainer\-: Chris Dilley \href{mailto:codemonkey941@gmail.com}{\tt codemonkey941@gmail.\-com} Section\-: libs Priority\-: optional Standards-\/\-Version\-: 3.\-9.\-5 Build-\/\-Depends\-: debhelper ($>$= 9), glfw, doxygen, libglew-\/dev, libfreetype6-\/dev, libfreetype6, libxrandr-\/dev, libxi-\/dev, x11proto-\/xf86vidmode-\/dev, libglu1-\/mesa-\/dev

Package\-: tsgl Architecture\-: amd64 Depends\-: \$\{shlibs\-:Depends\}, \$\{misc\-:Depends\}, glfw, libfreetype6, libfreetype6-\/dev, libglew-\/dev, libxrandr-\/dev, doxygen, devscripts, build-\/essential Description\-: A Thread-\/\-Safe Graphics Library.

The one for the trusty T\-S\-G\-L package is essentially the same, but with lib\-G\-L\-E\-W1.\-10 added to Build-\/\-Depends and Depends.

If nothing has changed (no new dependencies have been added...), simply copy and paste it into the new control file. Change the Maintainer field to your name and email associated with the ppa.

Save the changes and close the file. 

 \subsection*{$\vert$ compat file $\vert$ }

This is the easiest file to make. Create the file, and type \char`\"{}9\char`\"{}. Save the changes and don't touch the file again.

Essentially, all this file does is tell the packaging tools to use debhelper version 9.

This means, \char`\"{}\-Use the tools which help build Debian packages from version 9.\char`\"{} 

 \subsection*{$\vert$ rules file $\vert$ }

This file tells the build system how to make the binary package (in this case, the one that will be built in our ppa after we upload the source package).

As mentioned above, there are three components to a Debian package\-: upstream tarball, source package, and binary package.

We've already made the upstream tarball.

Our source and binary packages, however, will be made for us.

The source package will be made as a result of the work done in the next section.

The P\-P\-A has a build system which takes our uploaded source package and creates a binary package out of that.

It then publishes the upstream tarball, source package, and binary packages so that users can download and install tsgl.

You can upload binaries, though it is N\-O\-T recommended.

At any rate, this is what the rules files looks like for both the trusty and xenial packages\-:



 \subsection*{$\vert$ tsgl.\-install file $\vert$ }

This file explains where files need to go when the package is being installed.

Whenever something is installed on a user's system, certain files need to go to certain places.

An example would be an executable. Normally, you put executables inside of a user's /usr/bin when it is being installed.

This file specifies where certain files go on a user's system.

In our case, we need to put the libtsgl.\-so (and libtsgl.\-a file if created) into /usr/lib/, the .h files from src/\-T\-S\-G\-L into /usr/include/\-T\-S\-G\-L/, and the generic Makefile into /usr/include/\-T\-S\-G\-L\-M\-A\-K\-E/ (so users can create programs with T\-S\-G\-L with ease).



 \subsection*{$\vert$ source/format $\vert$ }



 \subsection*{$\vert$ copyright $\vert$ }

This file is used to store licensing information and legal stuff associated with your software.

In much the same way as inventors patent their products in order to protect them, software developers use licenses in order to protect their software.

\char`\"{}\-Protection\char`\"{} means not having your ideas stolen, etc.

It's essentially a way of telling everyone, \char`\"{}\-This software is availible for use, but with some restrictions.\char`\"{}

In the case of T\-S\-G\-L, we use the G\-P\-L v3 license.

This is located in the T\-S\-G\-L main folder, in a file called, \char`\"{}license\char`\"{}.

Simply open that file up, copy the contents, and paste them into the copyright file. 

 \subsection*{$\vert$ preinst $\vert$ }

This file is usually a shell/bash script that is executed before the installation of the package.

You can do all sorts of things with this file, ranging from checking library versions, to making sure that everything is in place for installing your package.

In the case of T\-S\-G\-L, we use this file to check the Open\-G\-L version.

It {\itshape M\-U\-S\-T} be 3.\-2 or greater, because T\-S\-G\-L relies on functions that were implemented in Open\-G\-L 3.\-2 and greater.

To check the Open\-G\-L version, one method that we used was\-:

\#!/bin/sh

vers\-Info=\$(glxinfo $\vert$ grep Open\-G\-L)

\#http\-://stackoverflow.com/questions/18147884/shell-\/variable-\/in-\/a-\/grep-\/regex \#\-Get the Open\-G\-L version string check=\char`\"{}\-Open\-G\-L version string\-: \char`\"{} vers\-String=\$(echo \char`\"{}\$vers\-Info\char`\"{} $\vert$ grep \char`\"{}\$check\char`\"{})

\#http\-://stackoverflow.com/questions/7516455/sed-\/extract-\/version-\/number-\/from-\/string-\/only-\/version-\/without-\/other-\/numbers \#http\-://superuser.com/questions/363865/how-\/to-\/extract-\/a-\/version-\/number-\/using-\/sed \#\-Extract the version number vers\-Num=\$(echo \char`\"{}\$vers\-String\char`\"{} $\vert$ sed 's/\mbox{[}$^\wedge$0-\/9.\mbox{]}$\ast$(\mbox{[}0-\/9.\mbox{]}$\ast$).$\ast$/\textbackslash{}1/')

\#http\-://tldp.org/\-L\-D\-P/abs/html/comparison-\/ops.\-html \#\-Check if the Open\-G\-L version number is 3.\-2 or greater. if \mbox{[}\mbox{[} \char`\"{}\$vers\-Num\char`\"{} $<$ \char`\"{}3.\-2\char`\"{} \mbox{]}\mbox{]} then exit 1 fi

Simply copy and paste the code above into the preinst file, save and then close it. 

 \subsection*{$\vert$ postinst $\vert$ }

This file is usually a shell/bash script that is executed after the installation of the package.

Whew, that was a lot of files!

Let's move onto the easiest part of Debian package creation\-: actually creating one! 

 \subsection*{$\vert$ Creating Debian packages\-: debuild is your friend $\vert$ }

So, you have created all of the files in the debian folder.

Now all that's left to do is to create the files needed in order to create our full Debian package and upload said package.

You'll also have to sign the package (so Debian knows that you made the package) with a G\-P\-G key, located in key\-I\-D.\-txt.

How do we do all that?

debuild.

debuild creates our Debian package and files needed in order to upload said package.

Simply type\-: \begin{DoxyVerb}cd ../
debuild -S -rfakeroot -k<key-id> (replacing <key-id> with the key ID located in key.txt). 
\end{DoxyVerb}


and debuild takes care of the rest!

debuild -\/\-S -\/rfakeroot -\/k$<$key-\/id$>$ cd .. ls $<$package-\/name$>$.source\-\_\-changes 

 \subsection*{$\vert$ M\-I\-S\-C $\vert$ }

Does something not make sense? Have we missed something? Take a look at these links for more information.

\href{https://wiki.debian.org/Packaging/Intro?action=show&redirect=IntroDebianPackaging}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Intro?action=show\&redirect=\-Intro\-Debian\-Packaging}

\href{https://en.wikipedia.org/wiki/Upstream_%28software_development%29}{\tt https\-://en.\-wikipedia.\-org/wiki/\-Upstream\-\_\-\%28software\-\_\-development\%29}

\href{https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Source\-Package?action=show\&redirect=\-Source\-Package}

\href{https://www.debian.org/doc/manuals/maint-guide/dreq.en.html}{\tt https\-://www.\-debian.\-org/doc/manuals/maint-\/guide/dreq.\-en.\-html}

\href{https://www.debian.org/doc/manuals/maint-guide/dreq.en.html#control}{\tt https\-://www.\-debian.\-org/doc/manuals/maint-\/guide/dreq.\-en.\-html\#control}

\href{https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage#Working_with_a_source_package}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Source\-Package?action=show\&redirect=\-Source\-Package\#\-Working\-\_\-with\-\_\-a\-\_\-source\-\_\-package}

$\ast$$\ast$$\ast$\-P\-L\-E\-A\-S\-E$\ast$$\ast$$\ast$ update this document if you come across new links, or if there's missing/false information. 