$\ast$$\ast$$\ast$\-W\-O\-R\-K I\-N P\-R\-O\-G\-R\-E\-S\-S!!!$\ast$$\ast$$\ast$ 

 \subsection*{$\vert$ H\-O\-W T\-O C\-R\-E\-A\-T\-E N\-E\-W T\-S\-G\-L D\-E\-B\-I\-A\-N P\-A\-C\-K\-A\-G\-E\-S F\-O\-R U\-B\-U\-N\-T\-U (Last updated\-: 08/09/16) $\vert$ }

$\ast$$\ast$$\ast$\-N\-O\-T\-E\-:$\ast$$\ast$$\ast$ {\itshape Before} reading this page, please make sure that you have read the following pages\-:


\begin{DoxyItemize}
\item \mbox{[}\mbox{[}G\-P\-G Keys and You\mbox{]}\mbox{]}
\item \mbox{[}\mbox{[}P\-P\-A and our T\-S\-G\-L team\mbox{]}\mbox{]}
\end{DoxyItemize}

(Example of making the same package for a different distro\-: tsgl (1.\-1-\/1$\sim$$<$distro-\/name$>$) $<$distro-\/name$>$

If you are creating a new T\-S\-G\-L package for a new distro, see $\ast$$\ast$$\ast$\-N\-E\-W P\-A\-G\-E C\-O\-M\-I\-N\-G S\-O\-O\-N$\ast$$\ast$$\ast$

$\ast$$\ast$$\ast$\-N\-O\-T\-E\-:$\ast$$\ast$$\ast$ This document attempts to guide you in the process of Debian package creation. Given that, package creation can be a long and complex process. If there's something that we missed, or perhaps have misleading information, please edit this page accordingly!

Hello!

So, you need to make a new Debian package for T\-S\-G\-L.

Package creation isn't trivial, and has a steep learning curve.

What's more, we think that creating a Debian package is a $\ast$$\ast$$\ast$\-L\-O\-T$\ast$$\ast$$\ast$ more complex than creating an R\-P\-M package.

The reason? Instead of having to keep track of one file (S\-P\-E\-C file), you have to keep track of multiple.

Luckily, this document will attempt to guide you through the process.

Let's get started with a brief intro to Debian packages. 

 \subsection*{$\vert$ Creating Debian packages\-: intro $\vert$ }

Before we can even begin to talk about how to build a Debian package, we need to know what's inside one.

So, what exactly is inside of a Debian package?

Magic? Close.

There are three components to a Debian package\-:

1). Upstream tarball -\/ the original source code for the library/application. This comes from developers \char`\"{}upstream\char`\"{}, which means that they are the original authors of the code.

2). Source package -\/ has all of the necessary files needed to compile/build the software. Includes\-: the upstream tarball with {\ttfamily .tar.\-gz} ending, a description file ({\ttfamily .dsc}), and a tarball with any changes made to the upstream source code and all files created for the Debian package (usually has a {\ttfamily .debian.\-tar.\-gz} or {\ttfamily .diff.\-gz} ending).

3). Binary packages -\/ what actually get installed on a user's system.

You usually have to get the upstream tarball from some developers who are working on a piece of software. (You type {\ttfamily apt-\/get source $<$package-\/name$>$} in order to fetch it).

In this case, however, the upstream tarball will be created by you.

Therefore, there is no need to get an upstream tarball. You'll create one yourself!

Follow these steps\-:

1). Create a new folder and call it {\ttfamily tsgl-\/$<$version-\/number$>$}, replacing {\ttfamily $<$version-\/number$>$} with whatever version T\-S\-G\-L is currently.

(If you've made minor changes, like new features or improvements, bump up the middle number by 1.

e.\-g. 1.\-1.\-1 -\/$>$ 1.\-2.\-1.

If you've added a bug fix, bump up the third number by one (or add 1 if there is no third number).

e.\-g. 1.\-3 -\/$>$ 1.\-3.\-1 O\-R 1.\-1.\-1 -\/$>$ 1.\-1.\-2

If you've made only improvements to the documentation, make no changes to the version number.)

2). Go to wherever you have the T\-S\-G\-L folder (which you can get using git if you don't have it; {\ttfamily git clone \href{https://www.github.com/Calvin-CS/TSGL.git}{\tt https\-://www.\-github.\-com/\-Calvin-\/\-C\-S/\-T\-S\-G\-L.\-git}}).

3). Take {\itshape A\-L\-L} of the files in the T\-S\-G\-L folder, and copy them over to the {\ttfamily tsgl-\/$<$version-\/number$>$} folder.

Okay, now we'll create the actual upstream tarball.

1). Open up a terminal, and go to the place where the {\ttfamily tsgl-\/$<$version-\/number$>$} folder is located.

2). Type\-:

``` \begin{DoxyVerb}tar czvf tsgl-<version-number>.tar.gz tsgl-<version-number>
\end{DoxyVerb}


```

3). Type {\ttfamily ls}, and you should see files that look like this\-:

``` \begin{DoxyVerb}tsgl-<version-number>.tar.gz tsgl-<version-number> 
\end{DoxyVerb}


```

Congrats! You created the upstream tarball, and have taken your first step in making a Debian package.

Now, let's take a closer look at the intricacies of debian package creation. 

 \subsection*{$\vert$ Creating Debian packages\-: files, files, and more files $\vert$ }

Now that you have the upstream tarball created, it's time to get into the nitty gritty details of Debian packaging.

We'll go into preparing the library so that it can be packaged up.

You know how you have to prepare a turkey before actually cooking it?

The process is somewhat similar when creating a Debian package.

Go into the {\ttfamily tsgl-\/$<$version-\/number$>$} folder after creating the upstream tarball. Create a folder named {\ttfamily debian}.

This one folder, {\ttfamily debian}, will store all of the necessary files needed in order to create a Debian package.

And quite a lot of files we need....


\begin{DoxyItemize}
\item {\ttfamily changelog}
\item {\ttfamily control}
\item {\ttfamily rules}
\item {\ttfamily compat}
\item {\ttfamily tsgl.\-install}
\item {\ttfamily copyright}
\item {\ttfamily source/format}
\item {\ttfamily postinst}
\end{DoxyItemize}

There are more, but these will suffice.

You're going to have to create each and every one of these files.

Like we said, a bit more complicated than R\-P\-M package creation.

Let's get started with the {\ttfamily changelog} file. 

 \subsection*{$\vert$ {\ttfamily changelog} file $\vert$ }

This file essentially explains what has been changed in the Debian package. Ranging from a minor change to the {\ttfamily control} file (explained shortly), or a full scale rework of the entire package, you have to explain what you changed in this file.

Don't worry, you don't have to explain $\ast$$\ast$$\ast$\-E\-V\-E\-R\-Y$\ast$$\ast$$\ast$ little detail. You only have to summarize your changes.

This file is also $\ast$$\ast$$\ast$\-E\-X\-T\-R\-E\-M\-E\-L\-Y$\ast$$\ast$$\ast$ picky in regards to format. There is a specific format for this file that {\itshape M\-U\-S\-T} be followed.

Since you're creating a brand new package, we assume that the only thing that has been changed is the T\-S\-G\-L source code.

To create the {\ttfamily changelog} file, be in the {\ttfamily tsgl-\/$<$version-\/number$>$} directory, and type this command\-:

``` \begin{DoxyVerb}dch --create -v <version-number> --package tsgl
\end{DoxyVerb}


{\ttfamily  (If}dch{\ttfamily isn't installed, type}sudo apt-\/get install devscripts``` and repeat this step).

You'll be asked to pick an editor. Pick whichever one is the easiest one to use.

Now, you should see something like this\-:

```

tsgl ($<$version-\/number$>$-\/$<$debnumber$>$) U\-N\-R\-E\-L\-E\-A\-S\-E\-D; urgency=medium


\begin{DoxyItemize}
\item Initial release. (Closes\-: \#\-X\-X\-X\-X\-X\-X)
\end{DoxyItemize}

-- kodemonkey $<$kodemonkey-\/desktop$>$ Mon, 06 Jun 2016 15\-:56\-:57 -\/0400

```

Let's break it down\-:


\begin{DoxyItemize}
\item {\ttfamily tsgl ($<$version-\/number$>$-\/$<$debnumber$>$)} specifies the name of the package and the current version number. The {\ttfamily $<$debnumber$>$} tells us what version is the D\-E\-B\-I\-A\-N package. You can create multiple versions of the same package, without changing the source code of the package software. Usually this is when a new dependency needs to be added, or a new file needs to be added to the {\ttfamily debian} folder. In this case, since we are creating it, set this number to 1.
\end{DoxyItemize}

If this were an already created package, and we didn't make any changes to the T\-S\-G\-L source code, but made changes to the {\ttfamily debian} files, we would have to add 1 to the {\ttfamily $<$debnumber$>$}

E.\-g. tsgl (1.\-1.\-2-\/1) -\/$>$ tsgl (1.\-1.\-2-\/$\ast$$\ast$$\ast$2$\ast$$\ast$$\ast$)


\begin{DoxyItemize}
\item {\ttfamily U\-N\-R\-E\-L\-E\-A\-S\-E\-D} specifies the Linux distro that we developed the library for.
\end{DoxyItemize}

{\ttfamily trusty} is for {\ttfamily Ubuntu 14.\-04}, {\ttfamily xenial} is for {\ttfamily Ubuntu 16.\-04}.

If you are creating a new T\-S\-G\-L package for either one of those distros, replace {\ttfamily U\-N\-R\-E\-L\-E\-A\-S\-E\-D} with the distro name.


\begin{DoxyItemize}
\item {\ttfamily urgency=medium} specifies the priority level for this package. You can leave it as is.
\item {\ttfamily $\ast$ Initial release.} specifies what has been changed in the library. You can leave it as is.
\item Remove the {\ttfamily (Closes\-: \#\-X\-X\-X\-X\-X\-X)} as that is for bug fixes.
\item {\ttfamily -\/-\/ kodemonkey $<$kodemonkey@kodemonkey-\/desktop$>$ Mon, 06 Jun 2016 15\-:56\-:57 -\/0400} specifies the person who made the changes ({\ttfamily kodemonkey}), an email that you can contact them by ({\ttfamily kodemonkey@kodemonkey-\/desktop}), and the time and date that the changes were made.
\end{DoxyItemize}

You'll want to replace the name and email with your name and email.

You should end up with a file like this after changes have been made\-:

```

tsgl (1.\-0-\/1) trusty; urgency=medium


\begin{DoxyItemize}
\item Initial release.
\end{DoxyItemize}

-- Chris Dilley \href{mailto:codemonkey941@gmail.com}{\tt codemonkey941@gmail.\-com} Mon, 06 Jun 2016 15\-:56\-:57 -\/0400

```

Save the changes and close the file.

Next, let's take a look at the {\ttfamily control} file. 

 \subsection*{$\vert$ {\ttfamily control} file $\vert$ }

This file tells {\ttfamily apt-\/get} how to manage the package.

It's also a real workhorse of a file.

Here's the general format\-:

```

1 Source\-: 2 Maintainer\-: 3 Section\-: 4 Priority\-: 5 Standards-\/\-Version\-: 6 Build-\/\-Depends\-: 7 8 Package\-: 9 Architecture\-: 10 Depends\-: 11 Description\-:

(Line numbers added)

```

As you can see, there are two sections. Lines 1-\/7 specify information for the source package, while lines 9-\/12 specify information for the binary package.

Let's break them down\-:

-\/---S\-O\-U\-R\-C\-E-\/---


\begin{DoxyItemize}
\item {\ttfamily Source} specifies the name of the source package.
\item {\ttfamily Maintainer} specifies the person who is keeping track of the package in terms of updates, tweaks, etc.
\item {\ttfamily Section} species the section of the distribution that the source package goes into (libs, for example).
\item {\ttfamily Priority} specifies the importance of this package.
\item {\ttfamily Standards-\/\-Version} specifies the Debian standards for packaging that we are following.
\item {\ttfamily Build-\/\-Depends} specifies what libraries need to be present in order to build our library.
\end{DoxyItemize}

-\/---B\-I\-N\-A\-R\-Y-\/---


\begin{DoxyItemize}
\item {\ttfamily Package} specifies the name of the package. Note that the Source and Package name fields do N\-O\-T have to be the same.
\item {\ttfamily Architecture} specifies the architectures that the binary package can be compiled for.
\item {\ttfamily Depends} specifies what libraries need to be present in order for our binary package to behave correctly.
\item {\ttfamily Description} specifies a short summary of what the package is.
\end{DoxyItemize}

At the time of this writing, this was the {\ttfamily control} file for the {\ttfamily trusty} T\-S\-G\-L debian package\-:

```

1 Source\-: tsgl 2 Maintainer\-: Chris Dilley \href{mailto:codemonkey941@gmail.com}{\tt codemonkey941@gmail.\-com} 3 Section\-: libs 4 Priority\-: optional 5 Standards-\/\-Version\-: 3.\-9.\-5 6 Build-\/\-Depends\-: debhelper ($>$= 9), glfw, doxygen, libglew-\/dev, libfreetype6-\/dev, libfreetype6, libxrandr-\/dev, libxi-\/dev, x11proto-\/xf86vidmode-\/dev, libglu1-\/mesa-\/dev 7 8 Package\-: tsgl 9 Architecture\-: amd64 10 Depends\-: \$\{shlibs\-:Depends\}, \$\{misc\-:Depends\}, glfw, libfreetype6, libfreetype6-\/dev, libglew-\/dev, libxrandr-\/dev, doxygen, devscripts, build-\/essential 11 Description\-: A Thread-\/\-Safe Graphics Library.

```

(Line numbers added)

The one for the {\ttfamily xenial} package is the same.

If nothing has changed (no new dependencies have been added...), simply copy and paste it into the new {\ttfamily control} file.

Change the {\ttfamily Maintainer} field to your name and email.

Save the changes and close the file. 

 \subsection*{$\vert$ {\ttfamily compat} file $\vert$ }

This is the easiest file to make. Create the file, and type {\ttfamily 9}. Save the changes and don't touch the file again.

Essentially, all this file does is tell the packaging tools to use {\ttfamily debhelper} version 9.

This means, \char`\"{}\-Use the tools which help build Debian packages from toolset version 9.\char`\"{} 

 \subsection*{$\vert$ {\ttfamily rules} file $\vert$ }

This file tells the build system how to make the binary package (in this case, the one that will be built in our ppa after we upload the source package).

As mentioned above, there are three components to a Debian package\-: upstream tarball, source package, and binary package.

We've already made the upstream tarball.

Our source and binary packages, however, will be made for us.

The source package will be made as a result of the work done in the next section.

The P\-P\-A has a build system which takes our uploaded source package and creates a binary package out of that.

It then publishes the upstream tarball, source package, and binary packages so that users can download and install tsgl.

You can upload binaries, though it is N\-O\-T recommended.

At any rate, this is what the {\ttfamily rules} files looks like for both the {\ttfamily trusty} and {\ttfamily xenial} packages\-:



 \subsection*{$\vert$ {\ttfamily tsgl.\-install} file $\vert$ }

This file explains where files need to go when the package is being installed.

Whenever something is installed on a user's system, certain files need to go to certain places.

An example would be an executable. Normally, you put executables inside of a user's {\ttfamily /usr/bin} or {\ttfamily /usr/local/bin} directory when it is being installed.

This file specifies where certain files go on a user's system.

In our case, we need to put the {\ttfamily libtsgl.\-so} and {\ttfamily libtsgl.\-a} files into {\ttfamily /usr/lib/}, the {\ttfamily .h} header files from {\ttfamily src/\-T\-S\-G\-L} into {\ttfamily /usr/include/\-T\-S\-G\-L/}, and the generic {\ttfamily Makefile} into {\ttfamily /usr/include/\-T\-S\-G\-L\-\_\-\-G\-E\-N\-E\-R\-I\-C\-\_\-\-M\-A\-K\-E\-F\-I\-L\-E/} (so users can create programs with T\-S\-G\-L with ease).



 \subsection*{$\vert$ {\ttfamily source/format} file $\vert$ }



 \subsection*{$\vert$ {\ttfamily copyright} file $\vert$ }

This file is used to store licensing information and legal stuff associated with your software.

In much the same way as inventors patent their products in order to protect them, software developers use licenses in order to protect their software.

\char`\"{}\-Protection\char`\"{} means not having your ideas stolen, etc.

It's essentially a way of telling everyone, \char`\"{}\-This software is available for use, but with some restrictions.\char`\"{}

In the case of T\-S\-G\-L, we use the G\-P\-L v3 license.

This is located in the T\-S\-G\-L main folder, in a file called, \char`\"{}license\char`\"{}.

Simply open that file up, copy the contents, and paste them into the {\ttfamily copyright} file.

Save the changes and close the file. 

 \subsection*{$\vert$ {\ttfamily postinst} file $\vert$ }

This file is usually a shell/bash script that is executed $\ast$$\ast$$\ast$after$\ast$$\ast$$\ast$ the installation of the package.

Whew, that was a lot of files!

Let's move onto the easiest part of Debian package creation\-: actually building one! 

 \subsection*{$\vert$ Creating Debian packages\-: {\ttfamily debuild} is your friend $\vert$ }

So, you have created all of the files in the debian folder.

Now all that's left to do is to create the files needed in order to create our full Debian package and upload said package.

You'll also have to sign the package (so Debian knows that you made the package) with a G\-P\-G key, located in key\-I\-D.\-txt.

How do we do all that?

With the {\ttfamily debuild} command.

The {\ttfamily debuild} command creates our Debian package and files needed in order to upload said package.

Simply type this command either inside of the {\ttfamily debian} directory or {\ttfamily tsgl-\/$<$version-\/number$>$} directory\-:

``` debuild -\/\-S -\/rfakeroot -\/k$<$key-\/id$>$

``` (replacing $<$key-\/id$>$ with the key I\-D located in key.\-txt).

and debuild takes care of the rest!

debuild -\/\-S -\/rfakeroot -\/k$<$key-\/id$>$ cd .. ls $<$package-\/name$>$.source\-\_\-changes 

 \subsection*{$\vert$ M\-I\-S\-C $\vert$ }

Does something not make sense? Have we missed something? Take a look at these links for more information.

\href{https://wiki.debian.org/Packaging/Intro?action=show&redirect=IntroDebianPackaging}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Intro?action=show\&redirect=\-Intro\-Debian\-Packaging}

\href{https://en.wikipedia.org/wiki/Upstream_%28software_development%29}{\tt https\-://en.\-wikipedia.\-org/wiki/\-Upstream\-\_\-\%28software\-\_\-development\%29}

\href{https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Source\-Package?action=show\&redirect=\-Source\-Package}

\href{https://www.debian.org/doc/manuals/maint-guide/dreq.en.html}{\tt https\-://www.\-debian.\-org/doc/manuals/maint-\/guide/dreq.\-en.\-html}

\href{https://www.debian.org/doc/manuals/maint-guide/dreq.en.html#control}{\tt https\-://www.\-debian.\-org/doc/manuals/maint-\/guide/dreq.\-en.\-html\#control}

\href{https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage#Working_with_a_source_package}{\tt https\-://wiki.\-debian.\-org/\-Packaging/\-Source\-Package?action=show\&redirect=\-Source\-Package\#\-Working\-\_\-with\-\_\-a\-\_\-source\-\_\-package}

$\ast$$\ast$$\ast$\-P\-L\-E\-A\-S\-E$\ast$$\ast$$\ast$ update this document if you come across new links, or if there's missing/false information. 