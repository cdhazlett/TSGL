<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>TSGL: Creating-New-Deb-Packages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TSGL
   </div>
   <div id="projectbrief">A thread-safe graphics library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Creating-New-Deb-Packages </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>***WORK IN PROGRESS!!!*** </p>
<hr/>
 <h2>| HOW TO CREATE NEW TSGL DEBIAN PACKAGES FOR UBUNTU (Last updated: 08/09/16) | </h2>
<p>***NOTE:*** <em>Before</em> reading this page, please make sure that you have read the following pages:</p>
<ul>
<li>[[GPG Keys and You]]</li>
<li>[[PPA and our TSGL team]]</li>
</ul>
<p>(Example of making the same package for a different distro: tsgl (1.1-1~&lt;distro-name&gt;) &lt;distro-name&gt;</p>
<p>If you are creating a new TSGL package for a new distro, see ***NEW PAGE COMING SOON***</p>
<p>***NOTE:*** This document attempts to guide you in the process of Debian package creation. Given that, package creation can be a long and complex process. If there's something that we missed, or perhaps have misleading information, please edit this page accordingly!</p>
<p>Hello!</p>
<p>So, you need to make a new Debian package for TSGL.</p>
<p>Package creation isn't trivial, and has a steep learning curve.</p>
<p>What's more, we think that creating a Debian package is a ***LOT*** more complex than creating an RPM package.</p>
<p>The reason? Instead of having to keep track of one file (SPEC file), you have to keep track of multiple.</p>
<p>Luckily, this document will attempt to guide you through the process.</p>
<p>Let's get started with a brief intro to Debian packages. </p>
<hr/>
 <h2>| Creating Debian packages: intro | </h2>
<p>Before we can even begin to talk about how to build a Debian package, we need to know what's inside one.</p>
<p>So, what exactly is inside of a Debian package?</p>
<p>Magic? Close.</p>
<p>There are three components to a Debian package:</p>
<p>1). Upstream tarball - the original source code for the library/application. This comes from developers "upstream", which means that they are the original authors of the code.</p>
<p>2). Source package - has all of the necessary files needed to compile/build the software. Includes: the upstream tarball with <code>.tar.gz</code> ending, a description file (<code>.dsc</code>), and a tarball with any changes made to the upstream source code and all files created for the Debian package (usually has a <code>.debian.tar.gz</code> or <code>.diff.gz</code> ending).</p>
<p>3). Binary packages - what actually get installed on a user's system.</p>
<p>You usually have to get the upstream tarball from some developers who are working on a piece of software. (You type <code>apt-get source &lt;package-name&gt;</code> in order to fetch it).</p>
<p>In this case, however, the upstream tarball will be created by you.</p>
<p>Therefore, there is no need to get an upstream tarball. You'll create one yourself!</p>
<p>Follow these steps:</p>
<p>1). Create a new folder and call it <code>tsgl-&lt;version-number&gt;</code>, replacing <code>&lt;version-number&gt;</code> with whatever version TSGL is currently.</p>
<p>(If you've made minor changes, like new features or improvements, bump up the middle number by 1.</p>
<p>e.g. 1.1.1 -&gt; 1.2.1.</p>
<p>If you've added a bug fix, bump up the third number by one (or add 1 if there is no third number).</p>
<p>e.g. 1.3 -&gt; 1.3.1 OR 1.1.1 -&gt; 1.1.2</p>
<p>If you've made only improvements to the documentation, make no changes to the version number.)</p>
<p>2). Go to wherever you have the TSGL folder (which you can get using git if you don't have it; <code>git clone <a href="https://www.github.com/Calvin-CS/TSGL.git">https://www.github.com/Calvin-CS/TSGL.git</a></code>).</p>
<p>3). Take <em>ALL</em> of the files in the TSGL folder, and copy them over to the <code>tsgl-&lt;version-number&gt;</code> folder.</p>
<p>Okay, now we'll create the actual upstream tarball.</p>
<p>1). Open up a terminal, and go to the place where the <code>tsgl-&lt;version-number&gt;</code> folder is located.</p>
<p>2). Type:</p>
<p>``` </p>
<pre class="fragment">tar czvf tsgl-&lt;version-number&gt;.tar.gz tsgl-&lt;version-number&gt;
</pre><p>```</p>
<p>3). Type <code>ls</code>, and you should see files that look like this:</p>
<p>``` </p>
<pre class="fragment">tsgl-&lt;version-number&gt;.tar.gz tsgl-&lt;version-number&gt; 
</pre><p>```</p>
<p>Congrats! You created the upstream tarball, and have taken your first step in making a Debian package.</p>
<p>Now, let's take a closer look at the intricacies of debian package creation. </p>
<hr/>
 <h2>| Creating Debian packages: files, files, and more files | </h2>
<p>Now that you have the upstream tarball created, it's time to get into the nitty gritty details of Debian packaging.</p>
<p>We'll go into preparing the library so that it can be packaged up.</p>
<p>You know how you have to prepare a turkey before actually cooking it?</p>
<p>The process is somewhat similar when creating a Debian package.</p>
<p>Go into the <code>tsgl-&lt;version-number&gt;</code> folder after creating the upstream tarball. Create a folder named <code>debian</code>.</p>
<p>This one folder, <code>debian</code>, will store all of the necessary files needed in order to create a Debian package.</p>
<p>And quite a lot of files we need....</p>
<ul>
<li><code>changelog</code></li>
<li><code>control</code></li>
<li><code>rules</code></li>
<li><code>compat</code></li>
<li><code>tsgl.install</code></li>
<li><code>copyright</code></li>
<li><code>source/format</code></li>
<li><code>postinst</code></li>
</ul>
<p>There are more, but these will suffice.</p>
<p>You're going to have to create each and every one of these files.</p>
<p>Like we said, a bit more complicated than RPM package creation.</p>
<p>Let's get started with the <code>changelog</code> file. </p>
<hr/>
 <h2>| <code>changelog</code> file | </h2>
<p>This file essentially explains what has been changed in the Debian package. Ranging from a minor change to the <code>control</code> file (explained shortly), or a full scale rework of the entire package, you have to explain what you changed in this file.</p>
<p>Don't worry, you don't have to explain ***EVERY*** little detail. You only have to summarize your changes.</p>
<p>This file is also ***EXTREMELY*** picky in regards to format. There is a specific format for this file that <em>MUST</em> be followed.</p>
<p>Since you're creating a brand new package, we assume that the only thing that has been changed is the TSGL source code.</p>
<p>To create the <code>changelog</code> file, be in the <code>tsgl-&lt;version-number&gt;</code> directory, and type this command:</p>
<p>``` </p>
<pre class="fragment">dch --create -v &lt;version-number&gt; --package tsgl
</pre><p><code> (If</code>dch<code>isn't installed, type</code>sudo apt-get install devscripts``` and repeat this step).</p>
<p>You'll be asked to pick an editor. Pick whichever one is the easiest one to use.</p>
<p>Now, you should see something like this:</p>
<p>```</p>
<p>tsgl (&lt;version-number&gt;-&lt;debnumber&gt;) UNRELEASED; urgency=medium</p>
<ul>
<li>Initial release. (Closes: #XXXXXX)</li>
</ul>
<p>&ndash; kodemonkey &lt;kodemonkey-desktop&gt; Mon, 06 Jun 2016 15:56:57 -0400</p>
<p>```</p>
<p>Let's break it down:</p>
<ul>
<li><code>tsgl (&lt;version-number&gt;-&lt;debnumber&gt;)</code> specifies the name of the package and the current version number. The <code>&lt;debnumber&gt;</code> tells us what version is the DEBIAN package. You can create multiple versions of the same package, without changing the source code of the package software. Usually this is when a new dependency needs to be added, or a new file needs to be added to the <code>debian</code> folder. In this case, since we are creating it, set this number to 1.</li>
</ul>
<p>If this were an already created package, and we didn't make any changes to the TSGL source code, but made changes to the <code>debian</code> files, we would have to add 1 to the <code>&lt;debnumber&gt;</code></p>
<p>E.g. tsgl (1.1.2-1) -&gt; tsgl (1.1.2-***2***)</p>
<ul>
<li><code>UNRELEASED</code> specifies the Linux distro that we developed the library for.</li>
</ul>
<p><code>trusty</code> is for <code>Ubuntu 14.04</code>, <code>xenial</code> is for <code>Ubuntu 16.04</code>.</p>
<p>If you are creating a new TSGL package for either one of those distros, replace <code>UNRELEASED</code> with the distro name.</p>
<ul>
<li><code>urgency=medium</code> specifies the priority level for this package. You can leave it as is.</li>
<li><code>* Initial release.</code> specifies what has been changed in the library. You can leave it as is.</li>
<li>Remove the <code>(Closes: #XXXXXX)</code> as that is for bug fixes.</li>
<li><code>-- kodemonkey &lt;kodemonkey@kodemonkey-desktop&gt; Mon, 06 Jun 2016 15:56:57 -0400</code> specifies the person who made the changes (<code>kodemonkey</code>), an email that you can contact them by (<code>kodemonkey@kodemonkey-desktop</code>), and the time and date that the changes were made.</li>
</ul>
<p>You'll want to replace the name and email with your name and email.</p>
<p>You should end up with a file like this after changes have been made:</p>
<p>```</p>
<p>tsgl (1.0-1) trusty; urgency=medium</p>
<ul>
<li>Initial release.</li>
</ul>
<p>&ndash; Chris Dilley <a href="#" onclick="location.href='mai'+'lto:'+'cod'+'em'+'onk'+'ey'+'941'+'@g'+'mai'+'l.'+'com'; return false;">codem<span style="display: none;">.nosp@m.</span>onke<span style="display: none;">.nosp@m.</span>y941@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> Mon, 06 Jun 2016 15:56:57 -0400</p>
<p>```</p>
<p>Save the changes and close the file.</p>
<p>Next, let's take a look at the <code>control</code> file. </p>
<hr/>
 <h2>| <code>control</code> file | </h2>
<p>This file tells <code>apt-get</code> how to manage the package.</p>
<p>It's also a real workhorse of a file.</p>
<p>Here's the general format:</p>
<p>```</p>
<p>1 Source: 2 Maintainer: 3 Section: 4 Priority: 5 Standards-Version: 6 Build-Depends: 7 8 Package: 9 Architecture: 10 Depends: 11 Description:</p>
<p>(Line numbers added)</p>
<p>```</p>
<p>As you can see, there are two sections. Lines 1-7 specify information for the source package, while lines 9-12 specify information for the binary package.</p>
<p>Let's break them down:</p>
<p>-&mdash;SOURCE-&mdash;</p>
<ul>
<li><code>Source</code> specifies the name of the source package.</li>
<li><code>Maintainer</code> specifies the person who is keeping track of the package in terms of updates, tweaks, etc.</li>
<li><code>Section</code> species the section of the distribution that the source package goes into (libs, for example).</li>
<li><code>Priority</code> specifies the importance of this package.</li>
<li><code>Standards-Version</code> specifies the Debian standards for packaging that we are following.</li>
<li><code>Build-Depends</code> specifies what libraries need to be present in order to build our library.</li>
</ul>
<p>-&mdash;BINARY-&mdash;</p>
<ul>
<li><code>Package</code> specifies the name of the package. Note that the Source and Package name fields do NOT have to be the same.</li>
<li><code>Architecture</code> specifies the architectures that the binary package can be compiled for.</li>
<li><code>Depends</code> specifies what libraries need to be present in order for our binary package to behave correctly.</li>
<li><code>Description</code> specifies a short summary of what the package is.</li>
</ul>
<p>At the time of this writing, this was the <code>control</code> file for the <code>trusty</code> TSGL debian package:</p>
<p>```</p>
<p>1 Source: tsgl 2 Maintainer: Chris Dilley <a href="#" onclick="location.href='mai'+'lto:'+'cod'+'em'+'onk'+'ey'+'941'+'@g'+'mai'+'l.'+'com'; return false;">codem<span style="display: none;">.nosp@m.</span>onke<span style="display: none;">.nosp@m.</span>y941@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> 3 Section: libs 4 Priority: optional 5 Standards-Version: 3.9.5 6 Build-Depends: debhelper (&gt;= 9), glfw, doxygen, libglew-dev, libfreetype6-dev, libfreetype6, libxrandr-dev, libxi-dev, x11proto-xf86vidmode-dev, libglu1-mesa-dev 7 8 Package: tsgl 9 Architecture: amd64 10 Depends: ${shlibs:Depends}, ${misc:Depends}, glfw, libfreetype6, libfreetype6-dev, libglew-dev, libxrandr-dev, doxygen, devscripts, build-essential 11 Description: A Thread-Safe Graphics Library.</p>
<p>```</p>
<p>(Line numbers added)</p>
<p>The one for the <code>xenial</code> package is the same.</p>
<p>If nothing has changed (no new dependencies have been added...), simply copy and paste it into the new <code>control</code> file.</p>
<p>Change the <code>Maintainer</code> field to your name and email.</p>
<p>Save the changes and close the file. </p>
<hr/>
 <h2>| <code>compat</code> file | </h2>
<p>This is the easiest file to make. Create the file, and type <code>9</code>. Save the changes and don't touch the file again.</p>
<p>Essentially, all this file does is tell the packaging tools to use <code>debhelper</code> version 9.</p>
<p>This means, "Use the tools which help build Debian packages from toolset version 9." </p>
<hr/>
 <h2>| <code>rules</code> file | </h2>
<p>This file tells the build system how to make the binary package (in this case, the one that will be built in our ppa after we upload the source package).</p>
<p>As mentioned above, there are three components to a Debian package: upstream tarball, source package, and binary package.</p>
<p>We've already made the upstream tarball.</p>
<p>Our source and binary packages, however, will be made for us.</p>
<p>The source package will be made as a result of the work done in the next section.</p>
<p>The PPA has a build system which takes our uploaded source package and creates a binary package out of that.</p>
<p>It then publishes the upstream tarball, source package, and binary packages so that users can download and install tsgl.</p>
<p>You can upload binaries, though it is NOT recommended.</p>
<p>At any rate, this is what the <code>rules</code> files looks like for both the <code>trusty</code> and <code>xenial</code> packages:</p>
<hr/>
 <h2>| <code>tsgl.install</code> file | </h2>
<p>This file explains where files need to go when the package is being installed.</p>
<p>Whenever something is installed on a user's system, certain files need to go to certain places.</p>
<p>An example would be an executable. Normally, you put executables inside of a user's <code>/usr/bin</code> or <code>/usr/local/bin</code> directory when it is being installed.</p>
<p>This file specifies where certain files go on a user's system.</p>
<p>In our case, we need to put the <code>libtsgl.so</code> and <code>libtsgl.a</code> files into <code>/usr/lib/</code>, the <code>.h</code> header files from <code>src/TSGL</code> into <code>/usr/include/TSGL/</code>, and the generic <code>Makefile</code> into <code>/usr/include/TSGL_GENERIC_MAKEFILE/</code> (so users can create programs with TSGL with ease).</p>
<hr/>
 <h2>| <code>source/format</code> file | </h2>
<hr/>
 <h2>| <code>copyright</code> file | </h2>
<p>This file is used to store licensing information and legal stuff associated with your software.</p>
<p>In much the same way as inventors patent their products in order to protect them, software developers use licenses in order to protect their software.</p>
<p>"Protection" means not having your ideas stolen, etc.</p>
<p>It's essentially a way of telling everyone, "This software is available for use, but with some restrictions."</p>
<p>In the case of TSGL, we use the GPL v3 license.</p>
<p>This is located in the TSGL main folder, in a file called, "license".</p>
<p>Simply open that file up, copy the contents, and paste them into the <code>copyright</code> file.</p>
<p>Save the changes and close the file. </p>
<hr/>
 <h2>| <code>postinst</code> file | </h2>
<p>This file is usually a shell/bash script that is executed ***after*** the installation of the package.</p>
<p>Whew, that was a lot of files!</p>
<p>Let's move onto the easiest part of Debian package creation: actually building one! </p>
<hr/>
 <h2>| Creating Debian packages: <code>debuild</code> is your friend | </h2>
<p>So, you have created all of the files in the debian folder.</p>
<p>Now all that's left to do is to create the files needed in order to create our full Debian package and upload said package.</p>
<p>You'll also have to sign the package (so Debian knows that you made the package) with a GPG key, located in keyID.txt.</p>
<p>How do we do all that?</p>
<p>With the <code>debuild</code> command.</p>
<p>The <code>debuild</code> command creates our Debian package and files needed in order to upload said package.</p>
<p>Simply type this command either inside of the <code>debian</code> directory or <code>tsgl-&lt;version-number&gt;</code> directory:</p>
<p>``` debuild -S -rfakeroot -k&lt;key-id&gt;</p>
<p>``` (replacing &lt;key-id&gt; with the key ID located in key.txt).</p>
<p>and debuild takes care of the rest!</p>
<p>debuild -S -rfakeroot -k&lt;key-id&gt; cd .. ls &lt;package-name&gt;.source_changes </p>
<hr/>
 <h2>| MISC | </h2>
<p>Does something not make sense? Have we missed something? Take a look at these links for more information.</p>
<p><a href="https://wiki.debian.org/Packaging/Intro?action=show&redirect=IntroDebianPackaging">https://wiki.debian.org/Packaging/Intro?action=show&amp;redirect=IntroDebianPackaging</a></p>
<p><a href="https://en.wikipedia.org/wiki/Upstream_%28software_development%29">https://en.wikipedia.org/wiki/Upstream_%28software_development%29</a></p>
<p><a href="https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage">https://wiki.debian.org/Packaging/SourcePackage?action=show&amp;redirect=SourcePackage</a></p>
<p><a href="https://www.debian.org/doc/manuals/maint-guide/dreq.en.html">https://www.debian.org/doc/manuals/maint-guide/dreq.en.html</a></p>
<p><a href="https://www.debian.org/doc/manuals/maint-guide/dreq.en.html#control">https://www.debian.org/doc/manuals/maint-guide/dreq.en.html#control</a></p>
<p><a href="https://wiki.debian.org/Packaging/SourcePackage?action=show&redirect=SourcePackage#Working_with_a_source_package">https://wiki.debian.org/Packaging/SourcePackage?action=show&amp;redirect=SourcePackage#Working_with_a_source_package</a></p>
<p>***PLEASE*** update this document if you come across new links, or if there's missing/false information. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 10 2016 11:29:51 for TSGL by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
